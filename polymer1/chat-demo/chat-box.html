<dom-module id="chat-box">
  <template>

    <style>
      :host .img-wrapper {
        height: 24px;
        width: 24px;
      }
      :host .content {
        max-width: 300px;
        cursor: pointer;
      }
      :host .message {
        display: flex;
        width: 100%;
        word-break: break-all;
        margin-bottom: 5px;
      }
      :host .self {
        flex-direction: row-reverse;
      }
    </style>

    <div class$="[[checkMessage(entity.id)]]">
      <div class="img-wrapper"><img src="./avatar0.jpg" alt="头像" height="100%" width="100%" style="border-radius: 22px;"></div>
      <div class="content">
        <template is="dom-if" if="[[showText(entity.content)]]">
          <pre style="margin: 0;">[[entity.content]]</pre>
        </template>
        <template is="dom-if" if="[[showImg(entity.content)]]">
          <img src$="[[entity.content]]" width="100%" height="100%">
        </template>
      </div>
    </div>

  </template>
  <script>
    Polymer({
      is: 'chat-box',
      properties: {
        entity: {
          type: Object,
          notify: true
        }
      },
      attached () {
        if (this.entity.shouldScroll) {
          Polymer.dom(this).node.scrollIntoView()
        }
      },
      showImg (content) {
        return /data:image\//.test(content)
      },
      showText (content) {
        return !this.showImg(content)
      },
      checkMessage (id) {
        switch (id) {
          case '0':
            return 'self message'
            break
          case '1':
            return 'message'
            break
          default:
            return 'message'
            break
        }
      }
    })
  </script>
</dom-module>